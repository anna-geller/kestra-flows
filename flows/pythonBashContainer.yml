id: pythonBashContainer
namespace: prod
description: |
  This flow starts a Docker container, installs custom packages, downloads a script from a GitHub repository,
  and runs that Python script inside the container using a Bash command.

inputs:
  - name: repositoryPath
    type: STRING
    defaults: anna-geller/kestra-flows/main/flows/etl_script.py
    required: false

tasks:
  - id: pythonContainer
    type: io.kestra.core.tasks.scripts.Bash
    commands:
      - TOKEN="{{ secret('GITHUB_TOKEN') }}"
      - curl -o etl_script.py https://$TOKEN@raw.githubusercontent.com/{{inputs.repositoryPath}}
      - python etl_script.py
    requirements:
      - requests
      - pandas
    runner: DOCKER
    dockerOptions:
      image: python:3.11-slim