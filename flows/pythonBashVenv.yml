id: pythonBashVenv
namespace: prod
description: |
  This flow creates a CSV file from a CLI using a Bash task.
  It then processes it using a standalone Python script triggered from CLI in a virtual environment.

inputs:
  - name: repositoryPath
    type: STRING
    defaults: anna-geller/kestra-flows/main/flows/etl_script.py
    required: false

tasks:
  - id: pythonVenvScript
    type: io.kestra.core.tasks.scripts.Bash
    description: you can skip the TOKEN if the GitHub repository is public
    commands:
      - TOKEN="{{ secret('GITHUB_TOKEN') }}"
      - curl -o etl_script.py https://$TOKEN@raw.githubusercontent.com/{{inputs.repositoryPath}}
      - python etl_script.py
    requirements:
      - requests
      - pandas
